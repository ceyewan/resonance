# ============================================================================
# Task 服务配置（本地直接运行）
# 用途：make dev - 本地直接运行 Go 程序，连接 127.0.0.1
# ============================================================================

service:
  name: task-service

log:
  level: debug
  format: console  # 开发环境使用 console 格式，方便调试
  output: stdout

mysql:
  name: task-mysql
  host: 127.0.0.1
  port: 3306
  username: resonance
  password: ""  # 从环境变量 RESONANCE_MYSQL_PASSWORD 读取
  database: resonance
  charset: utf8mb4
  max_idle_conns: 10
  max_open_conns: 20
  conn_max_lifetime: 1h

redis:
  name: task-redis
  addr: 127.0.0.1:6379
  password: ""
  db: 0
  pool_size: 20
  min_idle_conns: 10

nats:
  name: task-nats
  url: nats://127.0.0.1:4222
  max_reconnect: 10
  reconnect_delay: 1s

etcd:
  name: task-etcd
  endpoints:
    - 127.0.0.1:2379
  dial_timeout: 5s
  username: ""
  password: ""

registry:
  namespace: /resonance/services
  default_ttl: 30s
  enable_cache: true
  cache_expiration: 10s
  poll_interval: 10s  # 服务发现轮询间隔

gateway_service_name: gateway-service
gateway_queue_size: 1000     # 每个 Gateway 的推送队列大小
gateway_pusher_count: 3      # 每个 Gateway 的并发推送协程数

# 存储消费者配置（写扩散）
storage_consumer:
  topic: resonance.storage.event.v1
  queue_group: resonance_group_storage
  worker_count: 20
  max_retry: 3
  retry_interval: 5

# 推送消费者配置（在线推送）
push_consumer:
  topic: resonance.push.event.v1
  queue_group: resonance_group_push
  worker_count: 50
  max_retry: 3
  retry_interval: 5
