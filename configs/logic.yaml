# ============================================================================
# Logic 服务配置（本地直接运行）
# 用途：make dev - 本地直接运行 Go 程序，连接 127.0.0.1
# ============================================================================

service:
  name: logic-service
  host: localhost
  server_addr: :15090 # gRPC 服务地址 (5位数)

# 基础组件配置
log:
  level: debug
  format: console # 开发环境使用 console 格式，方便调试
  output: stdout

mysql:
  name: logic-mysql
  host: 127.0.0.1
  port: 3306
  username: resonance
  password: "" # 从环境变量 RESONANCE_MYSQL_PASSWORD 读取
  database: resonance
  charset: utf8mb4
  max_idle_conns: 10
  max_open_conns: 20
  conn_max_lifetime: 1h

redis:
  name: logic-redis
  addr: 127.0.0.1:6379
  password: ""
  db: 0
  pool_size: 20
  min_idle_conns: 10

nats:
  name: logic-nats
  url: nats://127.0.0.1:4222
  max_reconnect: 10
  reconnect_delay: 1s

etcd:
  name: logic-etcd
  endpoints:
    - 127.0.0.1:2379
  dial_timeout: 5s
  username: ""
  password: ""

# 服务注册发现配置
registry:
  namespace: /resonance/services
  default_ttl: 30s
  enable_cache: true
  cache_expiration: 10s

# 认证配置
auth:
  secret_key: "" # 从环境变量 RESONANCE_AUTH_SECRET_KEY 读取（生产环境必须设置）
  issuer: resonance-service
  access_token_ttl: 24h

# 管理员初始化配置
admin:
  username: ceyewan
  password: "" # 从环境变量 RESONANCE_ADMIN_PASSWORD 读取
  nickname: 管理员

# ID 生成器配置 (对齐 Gateway 分桶分发机制)
worker_id:
  max_id: 1024
  key: resonance:logic:worker

# 可观测性配置
observability:
  trace:
    disable: false # 开发环境启用 Trace
    endpoint: localhost:4317 # OTLP Collector 地址
    insecure: true # 开发环境使用不安全连接
    sampler: 1.0 # 开发环境 100% 采样
  metrics:
    port: 9091 # Prometheus 端口
    path: /metrics # Metrics 路径
    enable_runtime: true # 启用运行时指标

# Outbox Job 配置
outbox:
  batch_size: 100 # 每次处理的消息批次大小
  max_retries: 5 # 最大重试次数
  ticker_time: 1s # 扫描间隔
  worker_count: 5 # 并发处理的 Worker 数量
