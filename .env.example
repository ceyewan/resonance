# ============================================================================
# Resonance 环境变量示例（同时用于 Compose 和应用运行时）
# ============================================================================
# 使用方式：
#   1) cp .env.example .env
#   2) 修改本文件中的变量
#   3) docker compose / make up 读取 .env，并通过 env_file 注入容器
#
# 配置优先级（容器内）：
#   运行时环境变量 > configs/{service}.prod.yaml > configs/{service}.yaml
# ============================================================================

# ============================================================================
# 运行模式
# ============================================================================
# dev: 只加载 {service}.yaml
# prod: 叠加加载 {service}.prod.yaml（Docker/生产推荐）
RESONANCE_ENV=prod
RESONANCE_DEBUG_CONFIG=false

# ============================================================================
# Compose 编排变量
# ============================================================================
RESONANCE_IMAGE=ceyewan/resonance:local

# 挂载配置目录到容器 /app/configs（修改后重启容器即可生效）
RESONANCE_CONFIG_DIR=../configs

# 本地端口映射（生产建议留空，交给 Caddy）
GATEWAY_PORT_BINDING=127.0.0.1:8080:8080
WEB_PORT_BINDING=127.0.0.1:4173:4173

# 反向代理域名
CADDY_GATEWAY_DOMAIN=im-api.ceyewan.xyz
CADDY_WEB_DOMAIN=ceyewan.xyz

# Compose 容器 hostname（用于多实例命名）
RESONANCE_GATEWAY_HOSTNAME=gateway-service-001
RESONANCE_LOGIC_HOSTNAME=logic-service-001
RESONANCE_TASK_HOSTNAME=task-service-001
RESONANCE_WEB_HOSTNAME=web-service-001

# ============================================================================
# 基础设施与业务敏感配置（生产必须修改）
# ============================================================================
RESONANCE_POSTGRES_DATABASE=resonance
RESONANCE_POSTGRES_USER=resonance
RESONANCE_POSTGRES_PASSWORD=resonance123

# JWT
RESONANCE_AUTH_SECRET_KEY=replace-with-strong-secret-at-least-32-chars
RESONANCE_AUTH_ISSUER=resonance-service
RESONANCE_AUTH_ACCESS_TOKEN_TTL=24h

# init 模块管理员
RESONANCE_ADMIN_USERNAME=ceyewan
RESONANCE_ADMIN_PASSWORD=admin123
RESONANCE_ADMIN_NICKNAME=管理员

# ============================================================================
# 运行时可调参数（可选）
# ============================================================================
RESONANCE_REGISTRY_NAMESPACE=/resonance/services
RESONANCE_REGISTRY_DEFAULT_TTL=30s
RESONANCE_REGISTRY_ENABLE_CACHE=true

RESONANCE_LOG_FORMAT=json
RESONANCE_LOG_OUTPUT=stdout
RESONANCE_LOG_LEVEL=info

# ============================================================================
# Web 前端运行时配置（可选）
# ============================================================================
# 为空时：
#   API 默认：开发 http://<host>:8080，生产同源 origin
#   WS  默认：开发 ws://localhost:8080/ws，生产同源 /ws
# 生产双域名（如 web=ceyewan.xyz, api=im-api.ceyewan.xyz）建议显式设置：
#   RESONANCE_WEB_API_BASE_URL=https://im-api.ceyewan.xyz
#   RESONANCE_WEB_WS_BASE_URL=wss://im-api.ceyewan.xyz/ws
RESONANCE_WEB_API_BASE_URL=
RESONANCE_WEB_WS_BASE_URL=
