# ============================================================================
# Resonance IM System - 环境变量配置
# ============================================================================
# 使用说明：
#   1. 复制为 .env: cp .env.example .env
#   2. 修改配置（特别是密码）
#   3. 所有配置统一在此文件管理，避免分散到 Makefile 和脚本中
#
# 配置加载顺序（Genesis config）：
#   环境变量 > .env > configs/{service}.prod.yaml > configs/{service}.yaml
#
# 配置文件说明：
#   {service}.yaml      -> 开发环境配置（默认，console 日志，debug 级别）
#   {service}.prod.yaml -> 生产环境覆盖配置（JSON 日志，info 级别）
#
# 环境切换：
#   RESONANCE_ENV=dev  -> 只加载 {service}.yaml
#   RESONANCE_ENV=prod -> 加载 {service}.prod.yaml 覆盖 {service}.yaml
# ============================================================================

# ============================================================================
# 环境配置
# ============================================================================
# 环境模式（控制加载哪个配置文件）
# 留空或 dev：加载 {service}.yaml（本地直接运行，连接 127.0.0.1）
# prod：加载 {service}.prod.yaml（Docker 环境，连接 Docker hostname）
#
# 使用场景：
# - make dev（本地直接运行）：RESONANCE_ENV=
# - make up（Docker 环境）：RESONANCE_ENV=prod
# - 生产环境：RESONANCE_ENV=prod
RESONANCE_ENV=prod

# 是否打印最终生效的配置（调试用）
RESONANCE_DEBUG_CONFIG=false

# ============================================================================
# Docker 部署配置
# ============================================================================
# Docker 镜像
# 本地开发：ceyewan/resonance:local
# 生产环境：ceyewan/resonance:v0.1 或 ceyewan/resonance:latest
RESONANCE_IMAGE=ceyewan/resonance:local

# 端口绑定（本地开发暴露端口，生产环境留空）
# 本地开发：127.0.0.1:8080:8080
# 生产环境：留空（使用 Caddy 反向代理）
GATEWAY_PORT_BINDING=127.0.0.1:8080:8080
WEB_PORT_BINDING=127.0.0.1:4173:4173

# Caddy 域名（生产环境使用，本地开发留空）
CADDY_GATEWAY_DOMAIN=im-api.ceyewan.xyz
CADDY_WEB_DOMAIN=chat.ceyewan.xyz

# ============================================================================
# 服务配置
# ============================================================================
# 服务名称（用于服务发现）
RESONANCE_GATEWAY_SERVICE_NAME=gateway-service
RESONANCE_LOGIC_SERVICE_NAME=logic-service
RESONANCE_TASK_SERVICE_NAME=task-service

# 服务主机名（用于 Docker Compose）
RESONANCE_GATEWAY_HOSTNAME=gateway-service-001
RESONANCE_LOGIC_HOSTNAME=logic-service-001
RESONANCE_TASK_HOSTNAME=task-service-001
RESONANCE_WEB_HOSTNAME=web-service-001

# ============================================================================
# 敏感信息配置（生产环境必须修改）
# ============================================================================
# PostgreSQL 配置
RESONANCE_POSTGRES_DATABASE=resonance
RESONANCE_POSTGRES_USER=resonance
RESONANCE_POSTGRES_PASSWORD=resonance123

# JWT 认证密钥（生产环境必须使用强密钥，至少 32 字符）
RESONANCE_AUTH_SECRET_KEY=resonance-dev-secret-key-change-in-production-32chars
RESONANCE_AUTH_ISSUER=resonance-service
RESONANCE_AUTH_ACCESS_TOKEN_TTL=24h

# 管理员初始化（生产环境必须修改）
RESONANCE_ADMIN_USERNAME=ceyewan
RESONANCE_ADMIN_PASSWORD=admin123

# ============================================================================
# 服务注册发现配置
# ============================================================================
RESONANCE_REGISTRY_NAMESPACE=/resonance/services
RESONANCE_REGISTRY_TTL=30s
RESONANCE_REGISTRY_ENABLE_CACHE=true

# ============================================================================
# 日志配置
# ============================================================================
RESONANCE_LOG_FORMAT=json
RESONANCE_LOG_OUTPUT=stdout
RESONANCE_LOG_LEVEL=info

# ============================================================================
# Web 前端开发配置
# ============================================================================
RESONANCE_WEB_HOST=localhost
RESONANCE_WEB_PORT=5173
RESONANCE_WEB_BUILD_DIR=dist
